(()=>{var t={4036:()=>{jQuery((t=>{t("input[name=wc_deposit_option],input[name=wc_deposit_payment_plan]").on("change",(()=>{t("form").has("input[name=wc_deposit_option],input[name=wc_deposit_payment_plan]").trigger("woocommerce_variation_has_changed")}))}))}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,a),o.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t})(),a.p=window.wcpayAssets.url,(()=>{"use strict";const t=window.wp.hooks,e=t=>"undefined"!=typeof wcpayConfig?wcpayConfig[t]:n(t),n=t=>{let e=null;if("undefined"!=typeof wcpay_upe_config)e=wcpay_upe_config;else{if("object"!=typeof wc||void 0===wc.wcSettings)return null;e=wc.wcSettings.getSetting("woocommerce_payments_data")||{}}return e[t]||null},r=t=>"object"==typeof wcpayExpressCheckoutParams&&wcpayExpressCheckoutParams.hasOwnProperty(t)?wcpayExpressCheckoutParams[t]:"object"==typeof wcpayPaymentRequestParams&&wcpayPaymentRequestParams.hasOwnProperty(t)?wcpayPaymentRequestParams[t]:null,o=t=>r("wc_ajax_url").toString().replace("%%endpoint%%","wcpay_"+t),i=function(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"wcpay_";return t.toString().replace("%%endpoint%%",a+e)};class s{constructor(t,e){this.options=t,this.stripe=null,this.stripePlatform=null,this.request=e,this.isWooPayRequesting=!1}createStripe(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const r={locale:e};return a&&(r.stripeAccount=a),n&&(r.betas=n),new Stripe(t,r)}getStripeForUPE(t){return this.options.forceNetworkSavedCards=n("paymentMethodsConfig")[t].forceNetworkSavedCards,this.getStripe()}getStripe(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{publishableKey:e,accountId:a,forceNetworkSavedCards:n,locale:r,isStripeLinkEnabled:o}=this.options;if(n&&!t)return this.stripePlatform||(this.stripePlatform=this.createStripe(e,r)),this.stripePlatform;if(!this.stripe){let t=["card_country_event_beta_1"];o&&(t=t.concat(["link_autofill_modal_beta_1"])),this.stripe=this.createStripe(e,r,a,t)}return this.stripe}loadStripe(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((e=>{try{e(this.getStripe(t))}catch(t){e({error:t})}}))}confirmIntent(t,a){const n=t.match(/#wcpay-confirm-(pi|si):(.+):(.+):(.+)$/);if(!n)return!0;const o="si"===n[1];let i=n[2];const s=n[3],c=n[4],p=t.indexOf("order-pay"),u=p>-1&&t.substring(p).match(/\d+/);return u&&(i=u[0]),(()=>{const{locale:t,publishableKey:a}=this.options,n=e("accountIdForIntentConfirmation");return o?this.getStripe().handleNextAction({clientSecret:s}):n?this.createStripe(a,t,n).confirmCardPayment(s):this.getStripe(!0).handleNextAction({clientSecret:s})})().then((t=>{var n;const o=t.paymentIntent&&t.paymentIntent.id||t.setupIntent&&t.setupIntent.id||t.error&&t.error.payment_intent&&t.error.payment_intent.id||t.error.setup_intent&&t.error.setup_intent.id,s=null!==(n=r("ajax_url"))&&void 0!==n?n:e("ajaxUrl");return[this.request(s,{action:"update_order_status",order_id:i,_ajax_nonce:c,intent_id:o,payment_method_id:a||null}),t.error]})).then((t=>{let[e,a]=t;if(a)throw a;return e.then((t=>{const e="string"==typeof t?JSON.parse(t):t;if(e.error)throw e.error;return e.return_url}))}))}setupIntent(t){return this.request(e("ajaxUrl"),{action:"create_setup_intent","wcpay-payment-method":t,_ajax_nonce:e("createSetupIntentNonce")}).then((t=>{if(!t.success)throw t.data.error;return"succeeded"===t.data.status?t.data:this.getStripe().confirmCardSetup(t.data.client_secret).then((t=>{const{setupIntent:e,error:a}=t;if(a)throw a;return e}))}))}saveUPEAppearance(t,a){return this.request(e("ajaxUrl"),{elements_location:a,appearance:JSON.stringify(t),action:"save_upe_appearance",_ajax_nonce:e("saveUPEAppearanceNonce")}).then((t=>t.data)).catch((t=>{throw t.message?t:new Error(t.statusText)}))}paymentRequestCalculateShippingOptions(t){return this.request(o("get_shipping_options"),{security:r("nonce")?.shipping,is_product_page:r("is_product_page"),...t})}paymentRequestUpdateShippingDetails(t){return this.request(o("update_shipping_method"),{security:r("nonce")?.update_shipping,shipping_method:[t.id],is_product_page:r("is_product_page")})}paymentRequestGetCartDetails(){return this.request(o("get_cart_details"),{security:r("nonce")?.get_cart_details})}paymentRequestAddToCart(t){return this.request(o("add_to_cart"),{security:r("nonce")?.add_to_cart,...t})}paymentRequestEmptyCart(t){return this.request(o("empty_cart"),{security:r("nonce")?.empty_cart,booking_id:t})}paymentRequestGetSelectedProductData(t){return this.request(o("get_selected_product_data"),{security:r("nonce")?.get_selected_product_data,...t})}paymentRequestCreateOrder(t){return this.request(o("create_order"),{_wpnonce:r("nonce")?.checkout,...t})}initWooPay(t,a){if(!this.isWooPayRequesting){this.isWooPayRequesting=!0;const n=e("wcAjaxUrl"),r=e("initWooPayNonce");return this.request(i(n,"init_woopay"),{_wpnonce:r,email:t,user_session:a,order_id:e("order_id"),key:e("key"),billing_email:e("billing_email")}).finally((()=>{this.isWooPayRequesting=!1}))}}expressCheckoutAddToCart(t){const a=e("wcAjaxUrl"),n=e("addToCartNonce");return this.request(i(a,"add_to_cart"),{security:n,...t})}paymentRequestPayForOrder(t,e){return this.request(o("pay_for_order"),{_wpnonce:r("nonce")?.pay_for_order,order:t,...e})}pmmeGetCartData(){return fetch(`${n("storeApiURL")}/cart`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}))}}const c=window.wp.apiFetch;var p=a.n(c);const u=window.wp.url,l=window.wp.i18n,d=t=>{const e=t.items.map((t=>({amount:parseInt(t.prices.price,10),label:[t.name,t.quantity>1&&` (x${t.quantity})`].filter(Boolean).join(""),pending:!0})));return t.totals.total_tax&&e.push({amount:parseInt(t.totals.total_tax,10),label:(0,l.__)("Tax","woocommerce-payments"),pending:!0}),t.totals.total_shipping&&e.push({amount:parseInt(t.totals.total_shipping,10),label:(0,l.__)("Shipping","woocommerce-payments"),pending:!0}),e},y=t=>t.shipping_rates[0].shipping_rates.map((t=>({id:t.rate_id,label:t.name,amount:parseInt(t.price,10),detail:""}))),m=t=>"object"==typeof wcpayPaymentRequestParams&&wcpayPaymentRequestParams.hasOwnProperty(t)?wcpayPaymentRequestParams[t]:null,h=e=>new Promise((a=>{const n=setInterval((()=>{!1===(0,t.doingAction)(e)&&(clearInterval(n),a())}),500)}));class _{cartRequestHeaders={};async _request(t){return await p()({...t,path:(0,u.addQueryArgs)(t.path,{currency:m("checkout").currency_code.toUpperCase()}),headers:{...this.cartRequestHeaders,...t.headers}})}async placeOrder(t){return await this._request({method:"POST",path:"/wc/store/v1/checkout",credentials:"omit",headers:{"X-WooPayments-Express-Payment-Request":!0,"X-WooPayments-Express-Payment-Request-Nonce":m("nonce").tokenized_cart_nonce||void 0,...this.cartRequestHeaders},data:t})}async getCart(){return await this._request({method:"GET",path:"/wc/store/v1/cart"})}async createAnonymousCart(){const t=await this._request({method:"GET",path:"/wc/store/v1/cart",credentials:"omit",parse:!1});this.cartRequestHeaders={Nonce:t.headers.get("Nonce"),"X-WooPayments-Store-Api-Nonce":t.headers.get("Nonce"),"Cart-Token":t.headers.get("Cart-Token"),"X-WooPayments-Express-Payment-Request-Nonce":t.headers.get("X-WooPayments-Express-Payment-Request-Nonce")}}async updateCustomer(t){return await this._request({method:"POST",path:"/wc/store/v1/cart/update-customer",credentials:"omit",headers:{"X-WooPayments-Express-Payment-Request":!0,"X-WooPayments-Express-Payment-Request-Nonce":m("nonce").tokenized_cart_nonce||void 0,...this.cartRequestHeaders},data:t})}async selectShippingRate(t){return await this._request({method:"POST",path:"/wc/store/v1/cart/select-shipping-rate",credentials:"omit",data:t})}async addProductToCart(){const e={id:jQuery(".single_add_to_cart_button").val(),quantity:parseInt(jQuery(".quantity .qty").val(),10)||1,variation:[]};return await this._request({method:"POST",path:"/wc/store/v1/cart/add-item",credentials:"omit",data:(0,t.applyFilters)("wcpay.payment-request.cart-add-item",e)})}async emptyCart(){try{const t=(await this._request({method:"GET",path:"/wc/store/v1/cart",credentials:"omit"})).items.map((t=>this._request({method:"POST",path:"/wc/store/v1/cart/remove-item",credentials:"omit",data:{key:t.key}})));await Promise.all(t)}catch(t){}}}const w=window.lodash;window.wp.domReady;const g=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,o,i;const s=null!==(n=e("platformTrackerNonce"))&&void 0!==n?n:null===(o=r("nonce"))||void 0===o?void 0:o.platform_tracker,c=null!==(i=e("ajaxUrl"))&&void 0!==i?i:r("ajax_url"),p=new FormData;p.append("tracksNonce",s),p.append("action","platform_tracks"),p.append("tracksEventName",t),p.append("tracksEventProp",JSON.stringify(a)),fetch(c,{method:"post",body:p})};let v;const f=(0,w.debounce)((t=>{const e={google_pay:"gpay_button_load",apple_pay:"applepay_button_load"}[v];e&&g(e,{source:t})}),1e3),q=t=>{var e,a,n,r,o,i,s,c,p;return{shipping_address:{first_name:null!==(e=t.recipient?.split(" ")?.slice(0,1)?.join(" "))&&void 0!==e?e:"",last_name:null!==(a=t.recipient?.split(" ")?.slice(1)?.join(" "))&&void 0!==a?a:"",company:null!==(n=t.organization)&&void 0!==n?n:"",address_1:null!==(r=t.addressLine?.[0])&&void 0!==r?r:"",address_2:null!==(o=t.addressLine?.[1])&&void 0!==o?o:"",city:null!==(i=t.city)&&void 0!==i?i:"",state:null!==(s=t.region)&&void 0!==s?s:"",country:null!==(c=t.country)&&void 0!==c?c:"",postcode:null!==(p=t.postalCode?.replace(" ",""))&&void 0!==p?p:""}}},b=t=>{var e,a,n,r,o,i,s,c,p,u,l,d,y,m,h,_;const w=(null!==(e=t.paymentMethod?.billing_details?.name)&&void 0!==e?e:t.payerName)||"",g=null!==(a=t.paymentMethod?.billing_details?.address)&&void 0!==a?a:{},v=null!==(n=t.shippingAddress)&&void 0!==n?n:{},f="applePay"===t.walletName?"apple_pay":"google_pay";return{customer_note:t.order_comments,billing_address:{first_name:null!==(r=w.split(" ")?.slice(0,1)?.join(" "))&&void 0!==r?r:"",last_name:w.split(" ")?.slice(1)?.join(" ")||"-",company:null!==(o=g.organization)&&void 0!==o?o:"",address_1:null!==(i=g.line1)&&void 0!==i?i:"",address_2:null!==(s=g.line2)&&void 0!==s?s:"",city:null!==(c=g.city)&&void 0!==c?c:"",state:null!==(p=g.state)&&void 0!==p?p:"",postcode:null!==(u=g.postal_code)&&void 0!==u?u:"",country:null!==(l=g.country)&&void 0!==l?l:"",email:null!==(d=null!==(y=t.paymentMethod?.billing_details?.email)&&void 0!==y?y:t.payerEmail)&&void 0!==d?d:"",phone:null!==(m=null!==(h=t.paymentMethod?.billing_details?.phone)&&void 0!==h?h:t.payerPhone?.replace("/[() -]/g",""))&&void 0!==m?m:""},...q(v),payment_method:"woocommerce_payments",payment_data:[{key:"payment_request_type",value:f},{key:"wcpay-fraud-prevention-token",value:null!==(_=window.wcpayFraudPreventionToken)&&void 0!==_?_:""},{key:"wcpay-payment-method",value:t.paymentMethod?.id}]}};let P=null;const C={init:t=>{let{$container:e}=t;P=e},getElements:()=>jQuery(".wcpay-payment-request-wrapper,#wcpay-payment-request-button-separator"),blockButton:()=>{P.data("blockUI.isBlocked")||P.block({message:null})},unblockButton:()=>{C.show(),P.unblock()},showButton:t=>{P.length&&(C.show(),t.mount("#wcpay-payment-request-button"))},hide:()=>{C.getElements().hide()},show:()=>{C.getElements().show()}},k=C,R=()=>null;class S{isPaymentAborted=!1;areListenersInitialized=!1;cachedCartData=void 0;paymentRequestCartApi=void 0;wcpayApi=void 0;initialProductData=void 0;constructor(t){let{wcpayApi:e,paymentRequestCartApi:a,productData:n}=t;this.wcpayApi=e,this.paymentRequestCartApi=a,this.initialProductData=n}async startPaymentRequest(){const e=this,a=(t=>{let{stripe:e,cartData:a,productData:n}=t,r=m("checkout")?.country_code;return"PR"===r&&(r="US"),e.paymentRequest({country:r,requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:m("checkout")?.needs_payer_phone,...n?{currency:n.currency,total:n.total,displayItems:n.displayItems,requestShipping:n.needs_shipping}:{currency:a.totals.currency_code.toLowerCase(),total:{label:m("total_label"),amount:parseInt(a.totals.total_price,10)},requestShipping:"pay_for_order"!==m("button_context")&&a.needs_shipping,displayItems:d(a)}})})({stripe:this.wcpayApi.getStripe(),cartData:this.cachedCartData,productData:this.initialProductData}),n=await a.canMakePayment();if(!n)return void(0,t.doAction)("wcpay.payment-request.availability",{paymentRequestType:null});const r=n.applePay?"apple_pay":"google_pay";(0,t.doAction)("wcpay.payment-request.availability",{paymentRequestType:r}),v=r,f(m("button_context")),"product"===m("button_context")&&await this.paymentRequestCartApi.createAnonymousCart();const o=this.wcpayApi.getStripe().elements().create("paymentRequestButton",{paymentRequest:a,style:{paymentRequestButton:{type:m("button").type,theme:m("button").theme,height:m("button").height+"px"}}});k.showButton(o),this.attachPaymentRequestButtonEventListeners(),(0,t.removeAction)("wcpay.payment-request.update-button-data","automattic/wcpay/payment-request"),(0,t.addAction)("wcpay.payment-request.update-button-data","automattic/wcpay/payment-request",(async()=>{const t=await e.getCartData(),n=e.initialProductData?.needs_shipping||e.cachedCartData?.needs_shipping;e.cachedCartData=t,e.isPaymentAborted||n!==t.needs_shipping?e.init().then(R):a.update({total:{label:m("total_label"),amount:parseInt(t.totals.total_price,10)},displayItems:d(t)})}));const i=jQuery(".single_add_to_cart_button");o.on("click",(t=>((t=>{const e={google_pay:"gpay_button_click",apple_pay:"applepay_button_click"}[v];e&&g(e,{source:"product"})})(),m("login_confirmation")?(t.preventDefault(),void(t=>{if(!m("login_confirmation"))return;let e=m("login_confirmation")?.message;e=e.replace(/\*\*.*?\*\*/,"apple_pay"===t?"Apple Pay":"Google Pay"),e=e.replace(/\*\*/g,""),confirm(e)&&(window.location.href=m("login_confirmation")?.redirect_url)})(r)):i.is(".disabled")?(t.preventDefault(),void(i.is(".wc-variation-is-unavailable")?window.alert(window.wc_add_to_cart_variation_params?.i18n_unavailable_text||(0,l.__)("Sorry, this product is unavailable. Please choose a different combination.","woocommerce-payments")):window.alert((0,l.__)("Please select your product options before proceeding.","woocommerce-payments")))):void e.paymentRequestCartApi.addProductToCart()))),a.on("cancel",(()=>{e.isPaymentAborted=!0,e.paymentRequestCartApi.emptyCart()})),a.on("shippingaddresschange",(async t=>{try{const a=await e.paymentRequestCartApi.updateCustomer(q(t.shippingAddress));t.updateWith({status:"success",shippingOptions:y(a),total:{label:m("total_label"),amount:parseInt(a.totals.total_price,10)},displayItems:d(a)}),e.cachedCartData=a}catch(e){t.updateWith({status:"fail"})}})),a.on("shippingoptionchange",(async t=>{try{const a=await e.paymentRequestCartApi.selectShippingRate({package_id:0,rate_id:t.shippingOption.id});t.updateWith({status:"success",total:{label:m("total_label"),amount:parseInt(a.totals.total_price,10)},displayItems:d(a)}),e.cachedCartData=a}catch(e){t.updateWith({status:"fail"})}})),a.on("paymentmethod",(async a=>{try{const n=await e.paymentRequestCartApi.placeOrder({...b(a),extensions:(0,t.applyFilters)("wcpay.payment-request.cart-place-order-extension-data",{})}),r=e.wcpayApi.confirmIntent(n.payment_result.redirect_url);a.complete("success");let o="";o=!0===r?n.payment_result.redirect_url:await r,jQuery.blockUI({message:null,overlayCSS:{background:"#fff",opacity:.6}}),window.location=o}catch(t){a.complete("fail"),jQuery(".woocommerce-error").remove();const e=jQuery(".woocommerce-notices-wrapper").first();e.length&&(e.append(jQuery('<div class="woocommerce-error" />').text(t.message)),jQuery("html, body").animate({scrollTop:e.find(".woocommerce-error").offset().top},600))}}))}attachPaymentRequestButtonEventListeners(){if(this.areListenersInitialized)return;this.areListenersInitialized=!0;const e=jQuery(".quantity");e.on("input",".qty",(()=>{k.blockButton()})),e.on("input",".qty",function(t,e){let a,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){const r=this,o=arguments,i=n&&!a;clearTimeout(a),a=setTimeout((()=>{a=null,n||e.apply(r,o)}),t),i&&e.apply(r,o)}}(250,(async()=>{(0,t.doAction)("wcpay.payment-request.update-button-data"),await h("wcpay.payment-request.update-button-data"),k.unblockButton()})))}async getCartData(){if("product"!==m("button_context"))return await this.paymentRequestCartApi.getCart();const t=new _;await t.createAnonymousCart();const e=await t.addProductToCart();return t.emptyCart().finally(R),e}async init(){if(!this.cachedCartData)try{this.cachedCartData=await this.getCartData()}catch(t){}this.startPaymentRequest().then(R),this.isPaymentAborted=!1,this.cachedCartData&&(this.initialProductData=void 0)}}a(4036),(0,t.addFilter)("wcpay.payment-request.cart-place-order-extension-data","automattic/wcpay/payment-request",(t=>{const e=jQuery("#wcpay-express-checkout__order-attribution-inputs input");if(!e.length)return t;const a={};return e.each((function(){const t=jQuery(this).attr("name").replace("wc_order_attribution_",""),e=jQuery(this).val();t&&e&&(a[t]=e)})),{...t,"woocommerce/order-attribution":a}})),jQuery((e=>{e(document.body).on("woocommerce_variation_has_changed",(async()=>{try{k.blockButton(),(0,t.doAction)("wcpay.payment-request.update-button-data"),await h("wcpay.payment-request.update-button-data"),k.unblockButton()}catch(t){k.hide()}}))})),(0,t.addFilter)("wcpay.payment-request.cart-add-item","automattic/wcpay/payment-request",(t=>{const e=jQuery(".single_variation_wrap");if(!e.length)return t;const a=e.find('input[name="product_id"]').val();return{...t,id:parseInt(a,10)}})),(0,t.addFilter)("wcpay.payment-request.cart-add-item","automattic/wcpay/payment-request",(t=>{const e=jQuery(".variations_form");if(!e.length)return t;const a=[];return e.find(".variations select").each((function(){const t=jQuery(this),e=t.data("attribute_name")||t.attr("name");a.push({attribute:document.querySelector(`label[for="${e.replace("attribute_","")}"]`).innerHTML,value:t.val()||""})})),{...t,variation:[...t.variation,...a]}})),jQuery((e=>{if(m("has_block")&&"pay_for_order"!==m("button_context"))return;const a=m("stripe").publishableKey;if(!a)return;k.init({$container:e("#wcpay-payment-request-button")});const n=new s({publishableKey:a,accountId:m("stripe").accountId,locale:m("stripe").locale},((t,a)=>new Promise(((n,r)=>{e.post(t,a).then(n).fail(r)})))),r=new _,o=new S({wcpayApi:n,paymentRequestCartApi:r,productData:m("product")||void 0});"checkout"===m("button_context")&&"pay_for_order"!==m("button_context")||o.init(),e(document.body).on("updated_cart_totals",(()=>{(0,t.doAction)("wcpay.payment-request.update-button-data")})),e(document.body).on("updated_checkout",(()=>{(0,t.doAction)("wcpay.payment-request.update-button-data")}))}))})()})();