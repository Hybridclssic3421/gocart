(()=>{var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var a=e.g.document;if(!t&&a&&(a.currentScript&&(t=a.currentScript.src),!t)){var n=a.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p=window.wcpayAssets.url,(()=>{"use strict";const e=window.wp.i18n,t=window.wp.hooks,a=window.lodash,n=e=>"undefined"!=typeof wcpayConfig?wcpayConfig[e]:o(e),o=e=>{let t=null;if("undefined"!=typeof wcpay_upe_config)t=wcpay_upe_config;else{if("object"!=typeof wc||void 0===wc.wcSettings)return null;t=wc.wcSettings.getSetting("woocommerce_payments_data")||{}}return t[e]||null},i=e=>"object"==typeof wcpayExpressCheckoutParams&&wcpayExpressCheckoutParams.hasOwnProperty(e)?wcpayExpressCheckoutParams[e]:"object"==typeof wcpayPaymentRequestParams&&wcpayPaymentRequestParams.hasOwnProperty(e)?wcpayPaymentRequestParams[e]:null,r=e=>i("wc_ajax_url").toString().replace("%%endpoint%%","wcpay_"+e),s=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"wcpay_";return e.toString().replace("%%endpoint%%",a+t)};class p{constructor(e,t){this.options=e,this.stripe=null,this.stripePlatform=null,this.request=t,this.isWooPayRequesting=!1}createStripe(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const o={locale:t};return a&&(o.stripeAccount=a),n&&(o.betas=n),new Stripe(e,o)}getStripeForUPE(e){return this.options.forceNetworkSavedCards=o("paymentMethodsConfig")[e].forceNetworkSavedCards,this.getStripe()}getStripe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{publishableKey:t,accountId:a,forceNetworkSavedCards:n,locale:o,isStripeLinkEnabled:i}=this.options;if(n&&!e)return this.stripePlatform||(this.stripePlatform=this.createStripe(t,o)),this.stripePlatform;if(!this.stripe){let e=["card_country_event_beta_1"];i&&(e=e.concat(["link_autofill_modal_beta_1"])),this.stripe=this.createStripe(t,o,a,e)}return this.stripe}loadStripe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((t=>{try{t(this.getStripe(e))}catch(e){t({error:e})}}))}confirmIntent(e,t){const a=e.match(/#wcpay-confirm-(pi|si):(.+):(.+):(.+)$/);if(!a)return!0;const o="si"===a[1];let r=a[2];const s=a[3],p=a[4],c=e.indexOf("order-pay"),l=c>-1&&e.substring(c).match(/\d+/);return l&&(r=l[0]),(()=>{const{locale:e,publishableKey:t}=this.options,a=n("accountIdForIntentConfirmation");return o?this.getStripe().handleNextAction({clientSecret:s}):a?this.createStripe(t,e,a).confirmCardPayment(s):this.getStripe(!0).handleNextAction({clientSecret:s})})().then((e=>{var a;const o=e.paymentIntent&&e.paymentIntent.id||e.setupIntent&&e.setupIntent.id||e.error&&e.error.payment_intent&&e.error.payment_intent.id||e.error.setup_intent&&e.error.setup_intent.id,s=null!==(a=i("ajax_url"))&&void 0!==a?a:n("ajaxUrl");return[this.request(s,{action:"update_order_status",order_id:r,_ajax_nonce:p,intent_id:o,payment_method_id:t||null}),e.error]})).then((e=>{let[t,a]=e;if(a)throw a;return t.then((e=>{const t="string"==typeof e?JSON.parse(e):e;if(t.error)throw t.error;return t.return_url}))}))}setupIntent(e){return this.request(n("ajaxUrl"),{action:"create_setup_intent","wcpay-payment-method":e,_ajax_nonce:n("createSetupIntentNonce")}).then((e=>{if(!e.success)throw e.data.error;return"succeeded"===e.data.status?e.data:this.getStripe().confirmCardSetup(e.data.client_secret).then((e=>{const{setupIntent:t,error:a}=e;if(a)throw a;return t}))}))}saveUPEAppearance(e,t){return this.request(n("ajaxUrl"),{elements_location:t,appearance:JSON.stringify(e),action:"save_upe_appearance",_ajax_nonce:n("saveUPEAppearanceNonce")}).then((e=>e.data)).catch((e=>{throw e.message?e:new Error(e.statusText)}))}paymentRequestCalculateShippingOptions(e){return this.request(r("get_shipping_options"),{security:i("nonce")?.shipping,is_product_page:i("is_product_page"),...e})}paymentRequestUpdateShippingDetails(e){return this.request(r("update_shipping_method"),{security:i("nonce")?.update_shipping,shipping_method:[e.id],is_product_page:i("is_product_page")})}paymentRequestGetCartDetails(){return this.request(r("get_cart_details"),{security:i("nonce")?.get_cart_details})}paymentRequestAddToCart(e){return this.request(r("add_to_cart"),{security:i("nonce")?.add_to_cart,...e})}paymentRequestEmptyCart(e){return this.request(r("empty_cart"),{security:i("nonce")?.empty_cart,booking_id:e})}paymentRequestGetSelectedProductData(e){return this.request(r("get_selected_product_data"),{security:i("nonce")?.get_selected_product_data,...e})}paymentRequestCreateOrder(e){return this.request(r("create_order"),{_wpnonce:i("nonce")?.checkout,...e})}initWooPay(e,t){if(!this.isWooPayRequesting){this.isWooPayRequesting=!0;const a=n("wcAjaxUrl"),o=n("initWooPayNonce");return this.request(s(a,"init_woopay"),{_wpnonce:o,email:e,user_session:t,order_id:n("order_id"),key:n("key"),billing_email:n("billing_email")}).finally((()=>{this.isWooPayRequesting=!1}))}}expressCheckoutAddToCart(e){const t=n("wcAjaxUrl"),a=n("addToCartNonce");return this.request(s(t,"add_to_cart"),{security:a,...e})}paymentRequestPayForOrder(e,t){return this.request(r("pay_for_order"),{_wpnonce:i("nonce")?.pay_for_order,order:e,...t})}pmmeGetCartData(){return fetch(`${o("storeApiURL")}/cart`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}}const c=e=>"object"==typeof wcpayPaymentRequestParams&&wcpayPaymentRequestParams.hasOwnProperty(e)?wcpayPaymentRequestParams[e]:null,l=e=>({label:c("total_label"),amount:e}),u=e=>{if(!c("login_confirmation"))return;let t=c("login_confirmation")?.message;"payment_request_api"!==e&&(t=t.replace(/\*\*.*?\*\*/,"apple_pay"===e?"Apple Pay":"Google Pay")),t=t.replace(/\*\*/g,""),confirm(t)&&(window.location.href=c("login_confirmation")?.redirect_url)},d=async(e,t,a,n,o)=>{if("success"!==t.result)return n(o,(e=>{const t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild?t.firstChild.textContent:""})(t.messages));try{const n=e.confirmIntent(t.redirect);o.complete("success"),a(!0===n?t.redirect:await n)}catch(e){n(o,e.message)}},y=async(e,t,a,n)=>{const o=await e.paymentRequestCreateOrder((e=>{var t,a,n,o,i,r,s,p,c,l,u,d,y,m,_,h,g,w,P,q,f,b,v,R,k,S;const C=null!==(t=e?.paymentMethod?.billing_details?.name)&&void 0!==t?t:e.payerName,I=null!==(a=e?.paymentMethod?.billing_details?.email)&&void 0!==a?a:"",j=null!==(n=e?.paymentMethod?.billing_details?.phone)&&void 0!==n?n:"",x=null!==(o=e?.paymentMethod?.billing_details?.address)&&void 0!==o?o:{},E=null!==(i=e?.shippingAddress)&&void 0!==i?i:{},A=null!==(r=window.wcpayFraudPreventionToken)&&void 0!==r?r:"";let T="payment_request_api";return"applePay"===e?.walletName?T="apple_pay":"googlePay"===e?.walletName&&(T="google_pay"),{billing_first_name:null!==(s=C?.split(" ")?.slice(0,1)?.join(" "))&&void 0!==s?s:"",billing_last_name:C?.split(" ")?.slice(1)?.join(" ")||"-",billing_company:null!==(p=x?.organization)&&void 0!==p?p:"",billing_email:null!==(c=null!=I?I:e?.payerEmail)&&void 0!==c?c:"",billing_phone:null!==(l=null!=j?j:e?.payerPhone?.replace("/[() -]/g",""))&&void 0!==l?l:"",billing_country:null!==(u=x?.country)&&void 0!==u?u:"",billing_address_1:null!==(d=x?.line1)&&void 0!==d?d:"",billing_address_2:null!==(y=x?.line2)&&void 0!==y?y:"",billing_city:null!==(m=x?.city)&&void 0!==m?m:"",billing_state:null!==(_=x?.state)&&void 0!==_?_:"",billing_postcode:null!==(h=x?.postal_code)&&void 0!==h?h:"",shipping_first_name:null!==(g=E?.recipient?.split(" ")?.slice(0,1)?.join(" "))&&void 0!==g?g:"",shipping_last_name:null!==(w=E?.recipient?.split(" ")?.slice(1)?.join(" "))&&void 0!==w?w:"",shipping_company:null!==(P=E?.organization)&&void 0!==P?P:"",shipping_country:null!==(q=E?.country)&&void 0!==q?q:"",shipping_address_1:null!==(f=E?.addressLine?.[0])&&void 0!==f?f:"",shipping_address_2:null!==(b=E?.addressLine?.[1])&&void 0!==b?b:"",shipping_city:null!==(v=E?.city)&&void 0!==v?v:"",shipping_state:null!==(R=E?.region)&&void 0!==R?R:"",shipping_postcode:null!==(k=E?.postalCode)&&void 0!==k?k:"",shipping_method:[null!==(S=e?.shippingOption?.id)&&void 0!==S?S:null],order_comments:"",payment_method:"woocommerce_payments",ship_to_different_address:1,terms:1,"wcpay-payment-method":e?.paymentMethod?.id,payment_request_type:T,"wcpay-fraud-prevention-token":A}})(n));d(e,o,t,a,n)},m=e=>async(t,a,n,o)=>{const i=await t.paymentRequestPayForOrder(e,(e=>{let t="payment_request_api";return"applePay"===e?.walletName?t="apple_pay":"googlePay"===e?.walletName&&(t="google_pay"),{payment_method:"woocommerce_payments","wcpay-payment-method":e?.paymentMethod?.id,payment_request_type:t}})(o));d(t,i,a,n,o)};window.wp.domReady;const _=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a,o,r;const s=null!==(a=n("platformTrackerNonce"))&&void 0!==a?a:null===(o=i("nonce"))||void 0===o?void 0:o.platform_tracker,p=null!==(r=n("ajaxUrl"))&&void 0!==r?r:i("ajax_url"),c=new FormData;c.append("tracksNonce",s),c.append("action","platform_tracks"),c.append("tracksEventName",e),c.append("tracksEventProp",JSON.stringify(t)),fetch(p,{method:"post",body:c})};jQuery((n=>{if(wcpayPaymentRequestParams.has_block&&!wcpayPaymentRequestParams.is_pay_for_order)return;const o=wcpayPaymentRequestParams.stripe.publishableKey;if(!o)return;const i=new p({publishableKey:o,accountId:wcpayPaymentRequestParams.stripe.accountId,locale:wcpayPaymentRequestParams.stripe.locale},((e,t)=>new Promise(((a,n)=>{jQuery.post(e,t).then(a).fail(n)}))));let r;const s=e=>{const t={google_pay:"gpay_button_click",apple_pay:"applepay_button_click"};if(t.hasOwnProperty(r)){const a=t[r];_(a,{source:e})}},d=(0,a.debounce)((e=>{const t={google_pay:"gpay_button_load",apple_pay:"applepay_button_load"};if(t.hasOwnProperty(r)){const a=t[r];_(a,{source:e})}}),1e3),h={paymentAborted:!1,getAttributes:function(){const e=n(".variations_form").find(".variations select"),t={};let a=0,o=0;return e.each((function(){const e=n(this).data("attribute_name")||n(this).attr("name"),i=n(this).val()||"";i.length>0&&o++,a++,t[e]=i})),{count:a,chosenCount:o,data:t}},abortPayment:(e,t)=>{e.complete("fail"),n(".woocommerce-error").remove();const a=n(".woocommerce-notices-wrapper").first();a.length&&(a.append(n('<div class="woocommerce-error" />').text(t)),n("html, body").animate({scrollTop:a.find(".woocommerce-error").offset().top},600))},completePayment:e=>{h.block(),window.location=e},block:()=>{n.blockUI({message:null,overlayCSS:{background:"#fff",opacity:.6}})},addToCart:()=>{let e=n(".single_add_to_cart_button").val();n(".single_variation_wrap").length&&(e=n(".single_variation_wrap").find('input[name="product_id"]').val()),n(".wc-bookings-booking-form").length&&(e=n(".wc-booking-product-id").val());const t={product_id:e,qty:n(".quantity .qty").val(),attributes:n(".variations_form").length?h.getAttributes().data:[]},a=n("form.cart").serializeArray();return n.each(a,((e,a)=>{if(/^(addon-|wc_)/.test(a.name))if(/\[\]$/.test(a.name)){const e=a.name.substring(0,a.name.length-2);t[e]?t[e].push(a.value):t[e]=[a.value]}else t[a.name]=a.value})),i.paymentRequestAddToCart(t)},startPaymentRequest:e=>{const a=(e=>{let{stripe:t,total:a,requestShipping:n,displayItems:o}=e,i=c("checkout")?.country_code;"PR"===i&&(i="US");const r={total:l(a),currency:c("checkout")?.currency_code,country:i,requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:c("checkout")?.needs_payer_phone,requestShipping:n,displayItems:o};return t.paymentRequest(r)})(e),n=i.getStripe().elements(),o=h.createPaymentRequestButton(n,a),s=e=>{(0,t.doAction)("wcpay.payment-request.availability",e)};a.canMakePayment().then((e=>{e?(r=e.applePay?"apple_pay":e.googlePay?"google_pay":"payment_request_api",s({paymentRequestType:r}),d(wcpayPaymentRequestParams.button_context),h.attachPaymentRequestButtonEventListeners(o,a),h.showPaymentRequestButton(o)):s({paymentRequestType:null})})),a.on("cancel",(()=>{h.paymentAborted=!0})),a.on("shippingaddresschange",(e=>(async(e,t)=>{const a=await e.paymentRequestCalculateShippingOptions((n=t.shippingAddress,{first_name:null!==(o=n?.recipient?.split(" ")?.slice(0,1)?.join(" "))&&void 0!==o?o:"",last_name:null!==(i=n?.recipient?.split(" ")?.slice(1)?.join(" "))&&void 0!==i?i:"",company:"",address_1:null!==(r=n?.addressLine?.[0])&&void 0!==r?r:"",address_2:null!==(s=n?.addressLine?.[1])&&void 0!==s?s:"",city:null!==(p=n?.city)&&void 0!==p?p:"",state:null!==(c=n?.region)&&void 0!==c?c:"",country:null!==(l=n?.country)&&void 0!==l?l:"",postcode:null!==(u=n?.postalCode?.replace(" ",""))&&void 0!==u?u:""}));var n,o,i,r,s,p,c,l,u;t.updateWith({status:a.result,shippingOptions:a.shipping_options,total:a.total,displayItems:a.displayItems})})(i,e))),a.on("shippingoptionchange",(e=>(async(e,t)=>{const a=await e.paymentRequestUpdateShippingDetails(t.shippingOption);"success"===a.result&&t.updateWith({status:"success",total:a.total,displayItems:a.displayItems}),"fail"===a.result&&t.updateWith({status:"fail"})})(i,e))),a.on("paymentmethod",(t=>{var a;(null!==(a=e.handler)&&void 0!==a?a:y)(i,h.completePayment,h.abortPayment,t)}))},getSelectedProductData:()=>{let e=n(".single_add_to_cart_button").val();n(".single_variation_wrap").length&&(e=n(".single_variation_wrap").find('input[name="product_id"]').val()),n(".wc-bookings-booking-form").length&&(e=n(".wc-booking-product-id").val());const t=(n("#product-addons-total").data("price_data")||[]).reduce(((e,t)=>e+t.cost),0),a={};n("input[name=wc_deposit_option]").length&&(a.wc_deposit_option=n("input[name=wc_deposit_option]:checked").val()),n("input[name=wc_deposit_payment_plan]").length&&(a.wc_deposit_payment_plan=n("input[name=wc_deposit_payment_plan]:checked").val());const o={product_id:e,qty:n(".quantity .qty").val(),attributes:n(".variations_form").length?h.getAttributes().data:[],addon_value:t,...a};return i.paymentRequestGetSelectedProductData(o)},debounce:(e,t,a)=>{let n;return function(){const o=this,i=arguments,r=a&&!n;clearTimeout(n),n=setTimeout((()=>{n=null,a||t.apply(o,i)}),e),r&&t.apply(o,i)}},createPaymentRequestButton:(e,t)=>e.create("paymentRequestButton",{paymentRequest:t,style:{paymentRequestButton:{type:wcpayPaymentRequestParams.button.type,theme:wcpayPaymentRequestParams.button.theme,height:wcpayPaymentRequestParams.button.height+"px"}}}),attachPaymentRequestButtonEventListeners:(e,t)=>{wcpayPaymentRequestParams.is_product_page?h.attachProductPageEventListeners(e,t):h.attachCartPageEventListeners(e)},attachProductPageEventListeners:(t,a)=>{let o=[];const i=n(".single_add_to_cart_button");t.on("click",(t=>(s("product"),wcpayPaymentRequestParams.login_confirmation?(t.preventDefault(),void u(r)):i.is(".disabled")?(t.preventDefault(),void(i.is(".wc-variation-is-unavailable")?window.alert(window?.wc_add_to_cart_variation_params?.i18n_unavailable_text||(0,e.__)("Sorry, this product is unavailable. Please choose a different combination.","woocommerce-payments")):window.alert((0,e.__)("Please select your product options before proceeding.","woocommerce-payments")))):o.length>0?(t.preventDefault(),void window.alert(o)):void h.addToCart()))),n("input[name=wc_deposit_option],input[name=wc_deposit_payment_plan]").on("change",(()=>{n("form").has("input[name=wc_deposit_option],input[name=wc_deposit_payment_plan]").trigger("woocommerce_variation_has_changed")})),n(document.body).on("woocommerce_variation_has_changed",(()=>{h.blockPaymentRequestButton(),n.when(h.getSelectedProductData()).then((e=>{h.paymentAborted||wcpayPaymentRequestParams.product.needs_shipping!==e.needs_shipping?h.reInitPaymentRequest(e):a.update({total:e.total,displayItems:e.displayItems}),h.unblockPaymentRequestButton()})).catch((()=>{h.hide()}))})),n(".quantity").on("input",".qty",(()=>{h.blockPaymentRequestButton()})),n(".quantity").off("input",".qty").on("input",".qty",h.debounce(250,(()=>{h.blockPaymentRequestButton(),o=[],n.when(h.getSelectedProductData()).then((e=>{h.paymentAborted||wcpayPaymentRequestParams.product.needs_shipping!==e.needs_shipping?h.reInitPaymentRequest(e):a.update({total:e.total,displayItems:e.displayItems}),h.unblockPaymentRequestButton()}))})))},attachCartPageEventListeners:e=>{e.on("click",(e=>{wcpayPaymentRequestParams.login_confirmation&&(e.preventDefault(),u(r)),s(wcpayPaymentRequestParams.button_context)}))},getElements:()=>n(".wcpay-payment-request-wrapper,#wcpay-payment-request-button-separator"),hide:()=>{h.getElements().hide()},show:()=>{h.getElements().show()},showPaymentRequestButton:e=>{n("#wcpay-payment-request-button").length&&(h.show(),e.mount("#wcpay-payment-request-button"))},blockPaymentRequestButton:()=>{n("#wcpay-payment-request-button").data("blockUI.isBlocked")||n("#wcpay-payment-request-button").block({message:null})},unblockPaymentRequestButton:()=>{h.show(),n("#wcpay-payment-request-button").unblock()},reInitPaymentRequest:e=>{wcpayPaymentRequestParams.product.needs_shipping=e.needs_shipping,wcpayPaymentRequestParams.product.total=e.total,wcpayPaymentRequestParams.product.displayItems=e.displayItems,h.init()},init:()=>{if(wcpayPaymentRequestParams.is_pay_for_order){if(!window.wcpayPaymentRequestPayForOrderParams)return;const{total:{amount:e},displayItems:t,order:a}=wcpayPaymentRequestPayForOrderParams;h.startPaymentRequest({stripe:i.getStripe(),requestShipping:!1,total:e,displayItems:t,handler:m(a)})}else wcpayPaymentRequestParams.is_product_page?h.startPaymentRequest({stripe:i.getStripe(),total:wcpayPaymentRequestParams.product.total.amount,requestShipping:wcpayPaymentRequestParams.product.needs_shipping,displayItems:wcpayPaymentRequestParams.product.displayItems}):i.paymentRequestGetCartDetails().then((e=>{h.startPaymentRequest({stripe:i.getStripe(),total:e.total.amount,requestShipping:e.needs_shipping,displayItems:e.displayItems})}));h.paymentAborted=!1}};wcpayPaymentRequestParams.is_checkout_page&&!wcpayPaymentRequestParams.is_pay_for_order||h.init(),n(document.body).on("updated_cart_totals",(()=>{h.init()})),n(document.body).on("updated_checkout",(()=>{h.init()}));let g=!1;n(document.body).off("wc_booking_form_changed").on("wc_booking_form_changed",(()=>{g=!0})),n(document).ajaxComplete((function(e,t,a){if(g&&a.url===window.booking_form_params.ajax_url&&a.data.includes("wc_bookings_calculate_costs")&&t.responseText.includes("SUCCESS"))return h.blockPaymentRequestButton(),g=!1,h.addToCart().then((e=>{wcpayPaymentRequestParams.product.total=e.total,wcpayPaymentRequestParams.product.displayItems=e.displayItems,i.paymentRequestEmptyCart(e.bookingId),h.init(),h.unblockPaymentRequestButton()}))}))}))})()})();